# 手动输入卦象功能使用说明

## 功能概述

手动输入卦象功能允许用户直接输入六个爻的阴阳属性和动爻状态，快速创建卦象进行解析。这对于已知卦象信息（如从书籍、老师传授等渠道获得）的用户非常有用。

## 使用步骤

### 1. 选择手动输入方式

1. 访问起卦页面
2. 输入占问事项
3. 在起卦方法选择区域，点击**"手动输入"**按钮

### 2. 输入卦象信息

系统会显示六个爻位的输入界面，从上到下依次为：
- 上爻（第六爻）
- 五爻（第五爻）
- 四爻（第四爻）
- 三爻（第三爻）
- 二爻（第二爻）
- 初爻（第一爻）

每一爻需要设置：

#### 阴阳属性
- **阳爻（—）**: 点击"阳爻 —"按钮，一条完整的横线
- **阴爻（- -）**: 点击"阴爻 - -"按钮，两条断开的横线

#### 动爻标记
- 勾选"动爻 ○"复选框表示该爻为动爻（老阴或老阳）
- 动爻会变化成相反的爻，形成变卦

### 3. 开始起卦

设置完所有六个爻后，点击页面底部的**"开始起卦"**按钮，系统将：
1. 自动识别上卦和下卦
2. 确定卦名
3. 装纳甲、地支、五行、六亲、六神
4. 如有动爻，自动生成变卦
5. 跳转到排盘页面显示完整信息

## 示例

### 示例1：乾为天卦（无动爻）

```
上爻: 阳爻 —
五爻: 阳爻 —
四爻: 阳爻 —
三爻: 阳爻 —
二爻: 阳爻 —
初爻: 阳爻 —
```

所有爻都不勾选动爻，这样就得到纯阳的乾为天卦。

### 示例2：水雷屯卦（二爻动）

```
上爻: 阴爻 - -
五爻: 阳爻 —
四爻: 阴爻 - -
三爻: 阴爻 - - (勾选动爻)
二爻: 阳爻 —
初爻: 阴爻 - -
```

三爻为动爻，会变化为阳爻，从而产生变卦。

### 示例3：天地否卦（多个动爻）

```
上爻: 阳爻 — (勾选动爻)
五爻: 阳爻 —
四爻: 阳爻 —
三爻: 阴爻 - -
二爻: 阴爻 - - (勾选动爻)
初爻: 阴爻 - -
```

上爻和二爻为动爻，会同时变化，产生对应的变卦。

## 六爻基础知识

### 爻的排列顺序

六爻从下往上排列：
```
上爻 (第6爻) ━━━━━
五爻 (第5爻) ━━━━━
四爻 (第4爻) ━━━━━
━━━━━━━━━ (上下卦分界)
三爻 (第3爻) ━━━━━
二爻 (第2爻) ━━━━━
初爻 (第1爻) ━━━━━
```

### 阴阳爻的表示

- **阳爻**: 一条完整的长横线 `━━━━━`
- **阴爻**: 中间断开的两段 `━━ ━━`

### 动爻的含义

- **老阳**: 阳爻且为动爻，标记为 ○，会变为阴爻
- **老阴**: 阴爻且为动爻，标记为 ×，会变为阳爻
- **少阳**: 阳爻且非动爻，保持不变
- **少阴**: 阴爻且非动爻，保持不变

### 八卦组成

一个完整的六爻卦由两个三爻卦（八卦）组成：
- **上卦**: 第4、5、6爻（从下往上数）
- **下卦**: 第1、2、3爻（从下往上数）

八卦包括：
- 乾☰（三阳爻）
- 兑☱（上阴下二阳）
- 离☲（上阳中阴下阳）
- 震☳（上二阴下阳）
- 巽☴（上阳下二阴）
- 坎☵（上阴中阳下阴）
- 艮☶（上阳下二阴）
- 坤☷（三阴爻）

## 注意事项

### 1. 卦象输入要求
- 必须完整输入所有六个爻的信息
- 阴阳属性为必选项
- 动爻标记为可选项

### 2. 动爻数量
- 可以没有动爻（静卦）
- 可以有1个或多个动爻
- 所有爻都是动爻也是允许的（虽然比较罕见）

### 3. 卦象验证
- 系统会自动根据输入的爻象确定上下卦
- 自动查找对应的卦名
- 如果输入的爻象组合不在六十四卦中，系统会给出提示

### 4. 输入来源
适用于以下场景：
- 从易经书籍中查到的卦象
- 老师或专家给出的卦象
- 其他占卜方式（如梅花易数、金钱卦等）得到的卦象
- 想要研究特定卦象的情况

## 与其他起卦方式的区别

| 起卦方式 | 输入方式 | 适用场景 | 特点 |
|---------|---------|---------|------|
| 时间起卦 | 自动使用当前时间 | 即时占卜 | 简单快速，基于当下时空 |
| 数字起卦 | 输入三个数字 | 报数起卦 | 灵活，可用任意数字 |
| 手动摇卦 | 模拟摇铜钱 | 传统起卦模拟 | 接近传统，有随机性 |
| **手动输入** | **直接输入卦象** | **已知卦象信息** | **精确，用于研究和学习** |

## 常见问题

### Q1: 如何确定我输入的卦象是否正确？

A: 系统会在排盘页面显示：
- 卦名（如"水雷屯"）
- 上下卦名称
- 完整的装卦信息
- 如有动爻，还会显示变卦

您可以对照书籍或参考资料核对。

### Q2: 我不知道哪个是上卦哪个是下卦怎么办？

A: 不用担心！手动输入功能只需要您按照从上到下（上爻到初爻）的顺序输入即可，系统会自动判断：
- 第4、5、6爻（从下数）为上卦
- 第1、2、3爻为下卦

### Q3: 可以输入没有动爻的静卦吗？

A: 完全可以！如果所有爻都不勾选"动爻"，就会得到一个静卦（无变卦）。

### Q4: 动爻太多会不会影响解卦？

A: 不会影响系统处理，但在传统六爻理论中：
- 没有动爻：静卦，看本卦
- 1个动爻：看本卦和变卦
- 2个动爻：以变卦为主
- 3个动爻或以上：有特殊的解卦方法

AI解卦会综合考虑所有因素。

### Q5: 输入错了怎么办？

A: 在点击"开始起卦"之前，您可以随时修改任何一爻的属性。点击对应的按钮或复选框即可更改。

## 技术说明

### 数据格式

手动输入功能向后端发送以下数据：

```json
{
  "method": "input",
  "question": "占问事项",
  "data": {
    "lines": [1, 1, 1, 1, 1, 1],  // 0=阴 1=阳
    "changes": [false, false, false, false, true, false]  // 是否动爻
  }
}
```

### 处理流程

1. 前端收集六个爻的阴阳和动爻信息
2. 发送到后端API
3. 后端根据爻象识别上下卦
4. 查找对应的卦名
5. 进行装卦（纳甲、地支、五行、六亲、六神）
6. 如有动爻，生成变卦
7. 保存到数据库并返回结果

## 相关资源

- **完整项目文档**: `PROJECT_DOCUMENTATION.md`
- **快速参考**: `QUICK_REFERENCE.md`
- **API文档**: 见项目文档的"API接口说明"章节

---

**祝您使用愉快！**

如有问题或建议，欢迎反馈。
